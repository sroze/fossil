# Fossil's access tokens

## Context

- We want Fossil to be used as much as possible without the need for extra backend services, in
  multi-tenant or privacy-sensitive environments.

## Decision

- We enable clients to directly fetch from or write to Fossil using tokens that can easily be
  generated by client applications.

- Each store will allow a list of JSON Web Keys to generate [a signed token (JWS)](https://www.rfc-editor.org/rfc/rfc7515)
  that contains permissions to read or write from streams.

  - Fossil only stores the public keys (unless explicitly stated, for playground purposes).
  - Each JWT is store-specific and should expire, at some point.

- The payload has the following fields:

  - `fossil`
    - `store` (required) The identifier of the store.
    - `read` (optional)
      - `streams` A list of stream matchers, to which this token grants read permissions.
    - `write` (optional)
      - `streams` A list of stream matchers, to which this token grants read permissions.
      - `types` (optional) A list of event types allowed to be written.
      - `metadata` (optional) Any metadata that will be added to events when writing.

- A stream matcher can be:
  - `*` to indicate any stream.
  - The literal value (i.e. name of the stream)
  - A prefix (e.g. `Foo-*` to match `Foo-bar` and `Foo-baz`)
